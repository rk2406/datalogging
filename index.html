<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Socket.io</title>
    </head>
 
    <body>
        <h1>Communication with socket.io!</h1>
        <ul class="target"></ul>
        <div id="chartContainer" style="height: 300px; width: 100%;"></div>
        <script src="./node_modules/socket.io-client/dist/socket.io.js"></script>
        <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
        <script>
            var socket = io.connect('http://localhost:3333');
            socket.on('ping', function(globe){
                console.log(+(globe))
                var chart = new CanvasJS.Chart("chartContainer", {
                title: {
                    text: "Datalogger"
                },
                axisY: {
                    title: "Random data",
                    //suffix: " °C"
                },
                data: [{
                    type: "column",	
                    //yValueFormatString: "#,### °C",
                    indexLabel: "{y}",
                    dataPoints: [
                        { label: "data", y: 206 },
                    ]
                }]
            });

            function updateChart() {
                var boilerColor, deltaY, yVal;
                var dps = chart.options.data[0].dataPoints;
               var i=0;
                {

                    yVal = +(globe)
                    boilerColor = yVal > 100 ? "#FF2500" : yVal >= 30 ? "#FF6000" : yVal < 50 ? "#6B8E23 " : null;
                    dps[i] = {label: "Boiler "+(i+1) , y: yVal, color: boilerColor};
                }
                chart.options.data[0].dataPoints = dps; 
                chart.render();
            };
            updateChart();

            setInterval(function() {updateChart()}, 500);

            })
        </script>
    </body>
</html>